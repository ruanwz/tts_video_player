# TTS字幕视频播放器

一个支持TTS（文字转语音）功能的视频播放器，可以将字幕内容朗读出来，并支持在原声和TTS模式之间切换。

## 功能特点

- 📹 **标准视频播放**：支持所有HTML5支持的视频格式（MP4、WebM等）
- 📝 **字幕显示**：支持SRT字幕格式的加载和显示
- 🔊 **TTS朗读**：使用macOS系统TTS引擎朗读字幕内容
- 🔄 **模式切换**：一键切换原声和TTS模式
- ⚙️ **自定义设置**：
  - 选择不同的TTS语音
  - 调整朗读语速（0.5x - 2.0x）
- 🎨 **现代化界面**：响应式设计，支持移动端和桌面端

## 系统要求

- **操作系统**：macOS（其他系统也支持，但TTS效果可能不同）
- **浏览器**：Safari 14+ 或 Chrome 70+（需要支持Web Speech API）

## 使用方法

### 1. 启动播放器

直接在浏览器中打开 `index.html` 文件：

```bash
# 在macOS上
open index.html

# 或者使用本地服务器（推荐）
python3 -m http.server 8000
# 然后访问 http://localhost:8000
```

### 2. 加载内容

1. **上传视频文件**：点击"选择视频文件"按钮，选择你的视频文件
2. **上传字幕文件**：点击"选择字幕文件"按钮，选择SRT格式的字幕文件

### 3. 播放控制

- 使用视频播放器的标准控件控制播放、暂停、进度等
- 字幕会自动同步显示在视频下方

### 4. 切换模式

点击**切换按钮**在两种模式之间切换：

- **原声模式**（默认）：播放视频原始音频
- **TTS模式**：静音原始音频，使用TTS朗读字幕

### 5. TTS设置

在TTS控制面板中可以：
- **选择语音**：选择不同的系统语音（优先显示中文语音）
- **调整语速**：使用滑块调整朗读速度

## 字幕文件格式

播放器支持标准的SRT字幕格式。示例：

```srt
1
00:00:01,000 --> 00:00:04,000
这是第一句字幕

2
00:00:04,500 --> 00:00:08,000
这是第二句字幕
```

### SRT格式说明

- 第一行：序号
- 第二行：时间轴（开始时间 --> 结束时间）
- 第三行及以后：字幕文本
- 空行分隔不同的字幕块

## 技术实现

- **前端框架**：原生JavaScript（无需额外依赖）
- **视频播放**：HTML5 Video API
- **TTS引擎**：Web Speech API (SpeechSynthesis)
- **样式**：CSS3，响应式设计

## 工作原理

1. **视频播放**：使用HTML5 `<video>` 元素播放视频
2. **字幕解析**：JavaScript解析SRT文件，提取时间轴和文本
3. **字幕同步**：监听视频的 `timeupdate` 事件，根据当前时间显示对应字幕
4. **TTS朗读**：
   - 在TTS模式下，当新字幕出现时触发TTS朗读
   - 使用 `SpeechSynthesisUtterance` API创建朗读任务
   - 视频原声被静音，只播放TTS音频
5. **模式切换**：
   - 原声模式：`video.muted = false`，停止TTS
   - TTS模式：`video.muted = true`，启动TTS朗读

## 浏览器兼容性

| 浏览器 | 支持情况 | 说明 |
|--------|---------|------|
| Safari (macOS) | ✅ 完全支持 | 推荐使用，TTS音质最佳 |
| Chrome (macOS) | ✅ 完全支持 | 支持良好 |
| Firefox | ⚠️ 部分支持 | Web Speech API支持有限 |
| Edge | ✅ 支持 | Windows系统TTS |

## 常见问题

### Q: 为什么听不到TTS声音？

A: 请检查：
1. 是否已切换到TTS模式（按钮显示"当前: TTS字幕"）
2. 系统音量是否打开
3. 浏览器是否支持Web Speech API
4. 字幕文件是否正确加载

### Q: TTS语音列表为空？

A:
- 某些浏览器需要等待片刻让语音列表加载
- 尝试刷新页面
- 确认使用支持的浏览器（Safari或Chrome）

### Q: 字幕显示不正确？

A: 请确保字幕文件是标准的SRT格式，编码为UTF-8

### Q: 可以同时播放原声和TTS吗？

A: 目前不支持，这是设计上的选择。如需此功能可以修改代码去掉静音逻辑。

## 未来改进

- [ ] 支持更多字幕格式（VTT、ASS等）
- [ ] 支持字幕编辑和时间轴调整
- [ ] 添加字幕延迟调整功能
- [ ] 支持导出TTS音频文件
- [ ] 添加键盘快捷键
- [ ] Electron打包为独立应用

## 许可证

MIT License

## 贡献

欢迎提交Issue和Pull Request！

---

**享受你的观影体验！** 🎬🔊
